<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puissance 4</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body> 
    <h1 class="title">Puissance 4</h1>
    <div class="players-row">
    <section class="pion-selection">
    <h2>Joueur 1 : choisissez votre jeton</h2>
    <form method="post" action="/joueur" enctype="multipart/form-data">
        <input type="hidden" name="joueur" value="1">
        <div class="pions-1">
            <label><input type="radio" name="pion" value="sdm.jpg" required {{if inSlice "pawn1.svg" .TakenPawns}}disabled{{end}}> <img src="../images/sdm.jpg" alt="SDM" width="64"></label>
            <label><input type="radio" name="pion" value="kaaris.webp" {{if inSlice "pawn2.svg" .TakenPawns}}disabled{{end}}> <img src="../images/kaaris.webp" alt="Karis" width="64"></label>
            <label><input type="radio" name="pion" value="booba.png" {{if inSlice "pawn3.svg" .TakenPawns}}disabled{{end}}> <img src="../images/booba.png" alt="Booba" width="64"></label>
            <label><input type="radio" name="pion" value="naps.jpg" {{if inSlice "pawn4.svg" .TakenPawns}}disabled{{end}}> <img src="../images/naps.jpg" alt="Naps" width="64"></label>
            <label><input type="radio" name="pion" value="damso.jpg" {{if inSlice "pawn5.svg" .TakenPawns}}disabled{{end}}> <img src="../images/damso.jpg" alt="Damso" width="64"></label>
            <label><input type="radio" name="pion" value="tiako.jpg" {{if inSlice "pawn6.svg" .TakenPawns}}disabled{{end}}> <img src="../images/tiako.jpg" alt="Tiako" width="64"></label>
            <label><input type="radio" name="pion" value="leto.jpg" {{if inSlice "pawn7.svg" .TakenPawns}}disabled{{end}}> <img src="../images/leto.jpg" alt="Leto" width="64"></label>
            <label><input type="radio" name="pion" value="plk.jpg" {{if inSlice "pawn8.svg" .TakenPawns}}disabled{{end}}> <img src="../images/plk.jpg" alt="PLK" width="64"></label>
            <label><input type="radio" name="pion" value="niska.jpg" {{if inSlice "pawn9.svg" .TakenPawns}}disabled{{end}}> <img src="../images/niska.jpg" alt="Niska" width="64"></label>
            <label><input type="radio" name="pion" value="jul.jpg" {{if inSlice "pawn10.svg" .TakenPawns}}disabled{{end}}> <img src="../images/jul.jpg" alt="Jul" width="64"></label>
        </div>
        <button type="submit">Valider Joueur 1</button>
    </form>
    </section>
    <section class="pion-selection">
    <h2>Joueur 2 : choisissez votre jeton</h2>
    <form method="post" action="/joueur" enctype="multipart/form-data">
        <input type="hidden" name="joueur" value="2">
        <div class="pions-2">
            <label><input type="radio" name="pion" value="sdm.jpg" required {{if inSlice "pawn1.svg" .TakenPawns}}disabled{{end}}> <img src="../images/sdm.jpg" alt="SDM" width="64"></label>
            <label><input type="radio" name="pion" value="kaaris.webp" {{if inSlice "pawn2.svg" .TakenPawns}}disabled{{end}}> <img src="../images/kaaris.webp" alt="Karis" width="64"></label>
            <label><input type="radio" name="pion" value="booba.png" {{if inSlice "pawn3.svg" .TakenPawns}}disabled{{end}}> <img src="../images/booba.png" alt="Booba" width="64"></label>
            <label><input type="radio" name="pion" value="naps.jpg" {{if inSlice "pawn4.svg" .TakenPawns}}disabled{{end}}> <img src="../images/naps.jpg" alt="Naps" width="64"></label>
            <label><input type="radio" name="pion" value="damso.jpg" {{if inSlice "pawn5.svg" .TakenPawns}}disabled{{end}}> <img src="../images/damso.jpg" alt="Damso" width="64"></label>
            <label><input type="radio" name="pion" value="tiako.jpg" {{if inSlice "pawn6.svg" .TakenPawns}}disabled{{end}}> <img src="../images/tiako.jpg" alt="Tiako" width="64"></label>
            <label><input type="radio" name="pion" value="leto.jpg" {{if inSlice "pawn7.svg" .TakenPawns}}disabled{{end}}> <img src="../images/leto.jpg" alt="Leto" width="64"></label>
            <label><input type="radio" name="pion" value="plk.jpg" {{if inSlice "pawn8.svg" .TakenPawns}}disabled{{end}}> <img src="../images/plk.jpg" alt="PLK" width="64"></label>
            <label><input type="radio" name="pion" value="niska.jpg" {{if inSlice "pawn9.svg" .TakenPawns}}disabled{{end}}> <img src="../images/niska.jpg" alt="Niska" width="64"></label>
            <label><input type="radio" name="pion" value="jul.jpg" {{if inSlice "pawn10.svg" .TakenPawns}}disabled{{end}}> <img src="../images/jul.jpg" alt="Jul" width="64"></label>
        </div>
        <button type="submit">Valider Joueur 2</button>
    </form>
    </section>
    </div>
<a class = "jouer">JOUER</a>
<section class="board-section">
    <h2 class="plateau">Plateau</h2>
    <form method="post" action="/grille">
        <div class="board">
            <div class="buttons">
                <button type="submit" name="col" value="0">â–¼</button>
                <button type="submit" name="col" value="1">â–¼</button>
                <button type="submit" name="col" value="2">â–¼</button>
                <button type="submit" name="col" value="3">â–¼</button>
                <button type="submit" name="col" value="4">â–¼</button>
                <button type="submit" name="col" value="5">â–¼</button>
                <button type="submit" name="col" value="6">â–¼</button>
            </div>
        </div>
    </form>
</section>
</table>
    <!-- ðŸŽµ Script pour les sons des rappeurs -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const sounds = {
            "1": new Audio("/sounds/sdm.mp3"),
            "2": new Audio("/sounds/kaaris.mp3"),
            "3": new Audio("/sounds/booba.mp3"),
            "4": new Audio("/sounds/naps.mp3"),
            "5": new Audio("/sounds/damso.mp3"),
            "6": new Audio("/sounds/tiako.mp3"),
            "7": new Audio("/sounds/leto.mp3"),
            "8": new Audio("/sounds/plk.mp3"),
            "9": new Audio("/sounds/niska.mp3"),
            "10": new Audio("/sounds/jul.mp3"),
        };
        // Quand un joueur valide son pion â†’ joue le son correspondant
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', e => {
                const selected = form.querySelector('input[name="pion"]:checked');
                if (selected) {
                    const id = selected.value;
                    if (sounds[id]) {
                        sounds[id].currentTime = 0;
                        sounds[id].play();
                    }
                }
            });
        });
    });
</script>
<div id="board"></div>
<script>
  const ROWS = 6;
  const COLS = 7;
  const boardDiv = document.getElementById("board");
  let board = Array.from({ length: ROWS }, () => Array(COLS).fill(0));

  function renderBoard() {
    boardDiv.innerHTML = "";
    for (let r = 0; r < ROWS; r++) {
      for (let c = 0; c < COLS; c++) {
        const cell = document.createElement("div");
        cell.textContent = board[r][c] === 0 ? "." : board[r][c];
        cell.addEventListener("click", () => playMove(c));
        boardDiv.appendChild(cell);
      }
    }
  }

  function playMove(col) {
    for (let r = ROWS - 1; r >= 0; r--) {
      if (board[r][col] === 0) {
        board[r][col] = 1; // exemple : joueur 1
        renderBoard();
        return;
      }
    }
    alert("Colonne pleine !");
  }

  renderBoard();
</script>
</body>
</html>